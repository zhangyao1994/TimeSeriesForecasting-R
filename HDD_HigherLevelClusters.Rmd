---
title: "HigherLevelClusters"
author: "Yao"
date: "June 13, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Higher Level Clusters than CFG Explory

```{r load data}
# HDD data from IRIS
load("~/Yao_Rdata/HDD_QTY_IRIS.RData")

# CFG information
CFG.info <- read.csv("~/Yao_Excels/HDD_FY16_FY19M03_Transformed_filledAllFiscalQuarter.csv")

colnames(CFG.info)
CFG.info %>% select(CFG,Interface,Interface_Speed,Capacity,RPM,Interface_All,Form_Factor) %>%
  unique() -> CFG.attributes

# remove '_CFG' for CFG.attributes
CFG.attributes$CFG = as.factor(substr(CFG.attributes$CFG,1,nchar(as.character(CFG.attributes$CFG))-4))

```

```{r Join Tables to get CFG info}
CFG.names <- data.frame(unique(hdd_qty$CFG))
dimnames(CFG.names)[[2]] <- 'CFG'
CFG.names %>% left_join(CFG.attributes) -> CFG.names.joined
```


```{r Extract info from CFG names}
# Interface
NameInterface <- function(x){
  ifelse(grep('SAS12G',CFG), "SAS12G",
                                  ifelse(grep('SAS6G',CFG), "SAS6G",
                                         ifelse(grep('SATA*.6G',CFG),'SATA6G','NA')))
}

colnames(CFG.names.joined)
CFG.names.joined[is.na("Interface")]$Interface <- apply(CFG.names.joined[is.na("Interface"),], 1,NameInterface)

# It might be easier by joining tables.

# Capacity. Mannually Done.

# RPM. Mannually Done.

# Form factor. Mannually Done.
```


```{r Data Explorary}
# Weekly data from IRIS data
hdd_qty %>% group_by(CFG, Fiscal_Wk) %>%
  summarise(HDD_QTY = sum(PART_QTY)) %>%
  gather(Model,HDD_QTY,HDD_QTY)-> HDD_Weekly
```

