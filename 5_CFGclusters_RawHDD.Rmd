---
title: "IRIS HDD Data Exploratory Analytics: CFG Clusters"
author: "Yao"
date: "June 20, 2018"
output: html_document
---

Latest update: 7/10/2018

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(tidyverse)
library(scales)
library(ggthemes)
library(plotly)
library(reshape2)
library(imputeTS)
library(feather)
options(scipen = 999)
```

```{r load the IRIS HDD Sales Data}
hdd_qty <- read_feather("~/Yao_Rdata/HDD_QTY_IRIS.feather")
```

```{r CFG level exploration}
# Extract Quarterly Sales for each CFG
hdd_qty %>% 
  group_by(CFG,Fiscal_Qtr) %>%
  summarise(CFG_Fiscal_Qtr_QTY=sum(PART_QTY)) -> temp_qtr

# join the CFG attribute table
# CFG information
CFG.info <- read.csv("~/Yao_Excels/CFGnamesInfo_filled.csv")
HDD_clustered %>% select(CFG,CFGcluster) %>% unique() %>% left_join(CFG.info) -> CFG.cluster.joined
```

I want to check the attributes of different clusters and see what findings I would have.
```{r}
# join the CFG attribute table
# CFG information
CFG.info <- read.csv("~/Yao_Excels/CFGnamesInfo_filled.csv")
HDD_clustered %>% select(CFG,CFGcluster) %>% unique() %>% left_join(CFG.info) -> CFG.cluster.joined

# Interface
CFG.cluster.joined %>% select(CFGcluster,Interface) %>% 
  dcast(CFGcluster~Interface, fun.aggregate = length) %>%
  melt(id.vars = "CFGcluster", measure.vars = c(levels(factor(CFG.cluster.joined$Interface)))) %>%
  ggplot(aes(x = CFGcluster,y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge(width = .8), width = 0.7) +
  geom_text(aes(label = value), position = position_dodge(width = .8), vjust = -0.5) +
  labs(title = 'Interface Comparison of Different CFG Clusters', x = "CFG Clusters", y = "Interface",fill="Interface") + 
  theme_minimal(base_size = 14)

# Interface Speed
CFG.cluster.joined %>% select(CFGcluster,Interface_Speed) %>% 
  dcast(CFGcluster~Interface_Speed, fun.aggregate = length) %>%
  melt(id.vars = "CFGcluster", measure.vars = c(levels(factor(CFG.cluster.joined$Interface_Speed)))) %>%
  ggplot(aes(x = CFGcluster,y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge(width = .8), width = 0.7) +
  geom_text(aes(label = value), position = position_dodge(width = .8), vjust = -0.5) +
  labs(title = 'Interface Speed Comparison of Different CFG Clusters', x = "CFG Clusters", y = "Count", fill='Interface Speed') + 
  theme_minimal(base_size = 14) + 
  scale_fill_tableau('tableau10medium')

# Interface All
CFG.cluster.joined %>% select(CFGcluster,Interface_All) %>% 
  dcast(CFGcluster~Interface_All, fun.aggregate = length) %>%
  melt(id.vars = "CFGcluster", measure.vars = c(levels(factor(CFG.cluster.joined$Interface_All)))) %>%
  ggplot(aes(x = CFGcluster,y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge(width = .8), width = 0.7) +
  geom_text(aes(label = value), position = position_dodge(width = .8), vjust = -0.5) +
  labs(title = 'Interface All Comparison of Different CFG Clusters', x = "CFG Clusters", y = "Count", fill='Interface All') + 
  theme_minimal(base_size = 14) + 
  scale_fill_tableau('tableau10medium')

# Capacity
CFG.cluster.joined %>% select(CFGcluster,Capacity) %>% 
  dcast(CFGcluster~Capacity, fun.aggregate = length) %>%
  melt(id.vars = "CFGcluster", measure.vars = levels(factor(CFG.cluster.joined$Capacity))) %>%
  ggplot(aes(x = CFGcluster,y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge(width = .8), width = 0.7) +
  geom_text(aes(label = value), position = position_dodge(width = .8), vjust = -0.5) +
  labs(title = 'Capacity Comparison of Different CFG Clusters', x = "CFG Clusters", y = "Count", fill='Capacity') + 
  theme_minimal(base_size = 14)

# RPM
CFG.cluster.joined %>% select(CFGcluster,RPM) %>% 
  dcast(CFGcluster~RPM, fun.aggregate = length) %>%
  melt(id.vars = "CFGcluster", measure.vars = c(levels(factor(CFG.cluster.joined$RPM)))) %>%
  ggplot(aes(x = CFGcluster,y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge(width = .8), width = 0.7) +
  geom_text(aes(label = value), position = position_dodge(width = .8), vjust = -0.5) +
  labs(title = 'RPM Comparison of Different CFG Clusters', x = "CFG Clusters", y = "Count", fill='RPM') + 
  theme_minimal(base_size = 14) + 
  scale_fill_tableau('tableau10medium')

# Form Factor
CFG.cluster.joined %>% select(CFGcluster,Form_Factor) %>% 
  dcast(CFGcluster~Form_Factor, fun.aggregate = length) %>%
  melt(id.vars = "CFGcluster", measure.vars = c(levels(factor(CFG.cluster.joined$Form_Factor)))) %>%
  ggplot(aes(x = CFGcluster,y = value, fill = variable)) + 
  geom_bar(stat = "identity", position = position_dodge(width = .8), width = 0.7) +
  geom_text(aes(label = value), position = position_dodge(width = .8), vjust = -0.5) +
  labs(title = 'Form Factor Comparison of Different CFG Clusters', x = "CFG Clusters", y = "Count", fill='Form Factor') + 
  theme_minimal(base_size = 14) + 
  scale_fill_tableau('tableau10medium')
```


